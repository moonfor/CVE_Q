用户管理-导入用户处存在任意文件删除/读取



## 删除部分

导入用户，随意填入文件并抓包

![image-20250325175107359](任意文件删除+读取.assets/image-20250325175107359.png)

![image-20250326105050023](任意文件删除+读取.assets/image-20250326105050023.png)

全部放包，可见/etc/passwd已被删除，其他文件同理

![image-20250325175325402](任意文件删除+读取.assets/image-20250325175325402.png)



代码分析：

查看该接口，发现未过滤../，仅过滤了\\\

![image-20250326102742848](任意文件删除+读取.assets/image-20250326102742848.png)

跟进del，仍然没有过滤

![image-20250326102656406](任意文件删除+读取.assets/image-20250326102656406.png)

## 读取部分

从代码中可以看出，如果配置文件中存在=，可将行以=分割读取，并将结果展示在账号密码处

以/etc/sysctl.conf为例

![image-20250326104104010](任意文件删除+读取.assets/image-20250326104104010.png)

执行攻击过程后，该文件被同时删除且读取

![image-20250326103949678](任意文件删除+读取.assets/image-20250326103949678.png)